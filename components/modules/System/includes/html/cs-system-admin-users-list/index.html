<polymer-element name="cs-system-admin-users-list">
  <template>
    <template id="pagination">
      <p class="cs-left">
        <template if="{{users.length && users_count > search_limit}}">
          <ul class="uk-pagination" data-uk-pagination="{items:{{users_count}}, itemsOnPage:{{search_limit}}, currentPage:{{search_page}}}" on-click="{{page_click}}"></ul>
        </template>
        <!-- Stub to avoid table jumping when selecting pages or changing number of elements per page -->
        <template if="{{users.length > users_count}}">
          <ul class="uk-pagination">
            <li>
              <span>&nbsp;</span>
            </li>
          </ul>
        </template>
      </p>
    </template>
    <div class="uk-form">
      <ul class="cs-tabs">
        <li>[[L.search]]</li>
        <li>[[L.show_columns]]</li>
      </ul>
      <div>
        <div>
          <select value="{{search_column}}">
            <option selected value="">[[L.all_columns]]</option>
            <template repeat="{{column in all_columns}}">
              <option value="[[column]]">[[column]]</option>
            </template>
          </select>
          [[L.search_mode]]
          <select value="{{search_mode}}">
            <template repeat="{{mode in search_modes}}">
              <option selected?="[[mode == search_mode]]" value="[[mode]]">[[mode]]</option>
            </template>
          </select>
          <input class="uk-form-width-medium" placeholder="[[L.search_text]]" type="text" value="{{search_text}}">
          [[L.items]]
          <input min="1" step="1" type="number" value="{{search_limit}}">
        </div>
        <ul class="uk-padding-remove">
          <template repeat="{{column, index in search_columns}}">
            <template if="{{column.selected}}">
              <li class="cs-pointer uk-button uk-margin-bottom uk-button-primary" data-column-index="{{index}}" on-click="{{toggle_search_column}}">[[column.name]]</li>
            </template>
            <template if="{{!column.selected}}">
              <li class="cs-pointer uk-button uk-margin-bottom" data-column-index="{{index}}" on-click="{{toggle_search_column}}">[[column.name]]</li>
            </template>
          </template>
        </ul>
      </div>
      <hr>
      <template bind ref="pagination"></template>
      <cs-table center list with-header>
        <cs-table-row>
          <cs-table-cell>[[L.action]]</cs-table-cell>
          <cs-table-cell>&nbsp;</cs-table-cell>
          <template repeat="{{column in columns}}">
            <cs-table-cell>[[column]]</cs-table-cell>
          </template>
        </cs-table-row>
        <template repeat="{{user, index in users}}">
          <cs-table-row class="[[user.class]]" data-user-index="{{index}}">
            <cs-table-cell>
              <template if="[[user.is_root]]">-</template>
              <template if="[[!user.is_root]]">
                <template if="[[!user.is_guest]]">
                  <a class="uk-button cs-button-compact" data-uk-tooltip="[[tooltip_animation]]" on-click="[[edit_user]]" title="[[L.edit_user_information]]">
                    <div class="uk-icon-pencil"></div>
                  </a>
                </template>
                <template if="{{user.is_active && !user.is_guest}}">
                  <a class="uk-button cs-button-compact" data-uk-tooltip="[[tooltip_animation]]" href="/admin/System/users/users/deactivate/[[user.id]]" title="[[L.deactivate_user]]">
                    <div class="uk-icon-minus"></div>
                  </a>
                </template>
                <template if="{{!user.is_active && !user.is_guest}}">
                  <a class="uk-button cs-button-compact" data-uk-tooltip="[[tooltip_animation]]" href="/admin/System/users/users/activate/[[user.id]]" title="[[L.activate_user]]">
                    <div class="uk-icon-check"></div>
                  </a>
                </template>
                <template if="{{!user.is_guest && !user.is_bot}}">
                  <a class="uk-button cs-button-compact" data-uk-tooltip="[[tooltip_animation]]" href="/admin/System/users/users/groups/[[user.id]]" title="[[L.edit_user_groups]]">
                    <div class="uk-icon-group"></div>
                  </a>
                </template>
                <div class="uk-button cs-button-compact" data-uk-tooltip="[[tooltip_animation]]" on-click="[[edit_permissions]]" title="[[L.edit_user_permissions]]">
                  <div class="uk-icon-key"></div>
                </div>
              </template>
            </cs-table-cell>
            <cs-table-cell>
              <span data-uk-tooltip="[[tooltip_animation]]" title="[[user.type_info]]">[[user.type]]</span>
            </cs-table-cell>
            <template repeat="[[column in user.columns]]">
              <cs-table-cell>[[column]]</cs-table-cell>
            </template>
          </cs-table-row>
        </template>
      </cs-table>
    </div>
    <template if="{{!users.length}}">
      <h2 class="uk-text-center">
        <div class="uk-icon-spin uk-icon-spinner"></div>
      </h2>
    </template>
    <template bind ref="pagination"></template>
    <p class="cs-left">
      <button class="uk-button" on-click="[[add_user]]" type="button">[[L.add_user]]</button>
      <button class="uk-button" on-click="[[add_bot]]" type="button">[[L.add_bot]]</button>
    </p>
  </template>
  <script src="script.js"></script>
</polymer-element>
